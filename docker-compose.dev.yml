version: '3.4'

services:
  identifier:
    restart: "no"
    ports:
      - "80:80"
  dispatcher:
    restart: "no"
  triplestore:
    ports:
      - "8890:8890"
    restart: "no"
  db:
    restart: "no"
  migrations:
    restart: "no"
  resource:
    restart: "no"
  cache:
    restart: "no"
  kalliope-api:
    environment:
      SPRING_SECURITY_CONFIG: "/config/security-dev.yml"
    restart: "no"
  deltanotifier:
    restart: "no"
  mocklogin:
    image: lblod/mock-login-service:latest
    links:
      - db:database
  sink:
    restart: "no"
  login:
    restart: "no"
  accountdetail:
    restart: "no"
  privacy:
    restart: "no"
  adressenregister:
    restart: "no"
  frontend:
    image: nbittich/frontend-contact-hub
    restart: "no"
  uri-info:
    restart: "no"

  search:
    image: semtech/mu-search:0.8.0-beta.3
    links:
      - db:database
    volumes:
      - ./config/search:/config
  elasticsearch:
    ports:
      - "9200:9200"
      - "9300:9300"

    image: semtech/mu-search-elastic-backend:1.0.0
    volumes:
      - ./data/elasticsearch/:/usr/share/elasticsearch/data
    environment:
      - discovery.type=single-node